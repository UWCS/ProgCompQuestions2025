\begin{problem}{C.O.B.E.N (Hard Version)}{standard input}{standard output}{10 seconds}{512 megabytes}

\textbf{This is the hard version of the problem. The only difference between the two versions is the time limit, constraints on $n$, and that ties are permitted. You can make hacks only if both versions of the problem are solved.}

\textbf{Amog} the Mogger enters the \textbf{Moniforces} into a multiplayer Nim tournament. However, they don't know the optimal strategy and thus play no better than random. 

You are given $n$ players with their current scores $p_1, p_2, \ldots, p_n$ and $n$ non-negative bonuses $s_1, s_2, \ldots, s_n$. In the next round, each player will randomly receive one of the bonuses. The player with the lowest total score after the round will be eliminated. \textbf{In the event of a tie for the lowest total score among $k$ players, one of them is eliminated uniformly at random, with each having a probability of $\frac{1}{k}$.}

Your task is to calculate, for each player $i$, the exact probability of being eliminated after the next round, returned modulo $998244353$.

\InputFile
The first line contains $t \; (1 \leqslant t \leqslant 20)$, the number of test cases.

Then, $t$ test cases follow and for each test case:

The first line contains one integer, $n \, (1 \leqslant n \leqslant \bf{150})$

The second line contains $n$ space separated integers, where $p_i \, (0 \leqslant p_i \leqslant 10^9)$ represents the current score of player $i$.

The third line contains $n$ space separated integers, where $s_i \, (0 \leqslant s_i \leqslant 10^9)$ represents the score bonus associated with $i^{\text{th}}$ place.

It is guaranteed that the sum of $n$ over all test cases will not exceed $\bf{150}$.

\OutputFile
A single line containing $n$ integers, space separated, where the $i^{\text{th}}$ integer represents the probability $\text{mod } 998244353$ that player $i$ is eliminated.

It can be shown that the expected value has the form $\frac{P}{Q}$, where $P$ and $Q$ are non-negative coprime integers, and $Q \neq 0$. Report the value of $P \cdot Q^{-1} \pmod{998244353}$.

\Example

\begin{example}
\exmpfile{example.01}{example.01.a}%
\end{example}

\Note
We have 3 players with current scores $p = [60, 40, 20]$ and bonus options $s = [100, 50, 25]$. There are $3! = 6$ ways to assign the 3 bonuses, and in each assignment, the player with the lowest total $(p_i + s_{\pi(i)})$ is eliminated. Enumerating:   

1. $[160,90,45] \to $ Player 3 is eliminated.  

 
2. $[160,65,70]  \to $ Player 2 is eliminated. 

3. $[110,140,45]  \to $ Player 3 is eliminated.  

4. $[110,65,120]  \to $ Player 2 is eliminated. 

5. $[85,140,45]  \to $ Player 3 is eliminated. 

6. $[85,90,120]  \to $ Player 1 is eliminated. 


\textbf{Player 1} is eliminated in 1 of 6 permutations $(\frac{1}{6})$.   

 
\textbf{Player 2} is eliminated in 2 of 6 permutations $(\frac{1}{3})$.    


\textbf{Player 3} is eliminated in 3 of 6 permutations $(\frac{1}{2})$.

A tie is possible for the last test case; if we allocate the score bonus $5$ to player 1 and the score bonus $4$ to player 2, both end with a total score of $8$. Therefore, we begin the procedure and uniformly pick one of them at random, which means they each have a $\frac{1}{2}$ chance of being eliminated if those score bonuses are allocated in that manner. The probabilities of elimination over all permutations are $\frac{3}{4}$ for player 1 and $\frac{1}{4}$ for player 2.

\end{problem}

