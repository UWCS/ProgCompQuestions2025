{"extraResources":{"example.01.mu":"TVXzATMNCjMNCjYwIDQwIDIwDQoxMDAgNTAgMjUNCjYNCjc0OTUgNDkyOSA1MTE3IDY2NTcgNTc2MyA3NTIxDQo1NzY3IDQwMzcgMjgzMyAyMzA3IDE3MzAgMTQ0Mg0KMg0KMyA0DQo1IDQNCg=="},"scoring":null,"notes":"We have 3 players with current scores $p = [60, 40, 20]$ and bonus options $s = [100, 50, 25]$. There are $3! = 6$ ways to assign the 3 bonuses, and in each assignment, the player with the lowest total $(p_i + s_{\\pi(i)})$ is eliminated. Enumerating:   \r\n\r\n1. $[160,90,45] \\to $ Player 3 is eliminated.  \r\n\r\n \r\n2. $[160,65,70]  \\to $ Player 2 is eliminated. \r\n\r\n3. $[110,140,45]  \\to $ Player 3 is eliminated.  \r\n\r\n4. $[110,65,120]  \\to $ Player 2 is eliminated. \r\n\r\n5. $[85,140,45]  \\to $ Player 3 is eliminated. \r\n\r\n6. $[85,90,120]  \\to $ Player 1 is eliminated. \r\n\r\n\r\n\\textbf{Player 1} is eliminated in 1 of 6 permutations $(\\frac{1}{6})$.   \r\n\r\n \r\n\\textbf{Player 2} is eliminated in 2 of 6 permutations $(\\frac{1}{3})$.    \r\n\r\n\r\n\\textbf{Player 3} is eliminated in 3 of 6 permutations $(\\frac{1}{2})$.\r\n\r\nA tie is possible for the last test case; if we allocate the score bonus $5$ to player 1 and the score bonus $4$ to player 2, both end with a total score of $8$. Therefore, we begin the procedure and uniformly pick one of them at random, which means they each have a $\\frac{1}{2}$ chance of being eliminated if those score bonuses are allocated in that manner. The probabilities of elimination over all permutations are $\\frac{3}{4}$ for player 1 and $\\frac{1}{4}$ for player 2.","legend":"\\textbf{This is the hard version of the problem. The only difference between the two versions is the time limit, constraints on $n$, and that ties are permitted. You can make hacks only if both versions of the problem are solved.}\r\n\r\n\\textbf{Amog} the Mogger enters the \\textbf{Moniforces} into a multiplayer Nim tournament. However, they don't know the optimal strategy and thus play no better than random. \r\n\r\nYou are given $n$ players with their current scores $p_1, p_2, \\ldots, p_n$ and $n$ non-negative bonuses $s_1, s_2, \\ldots, s_n$. In the next round, each player will randomly receive one of the bonuses. The player with the lowest total score after the round will be eliminated. \\textbf{In the event of a tie for the lowest total score among $k$ players, one of them is eliminated uniformly at random, with each having a probability of $\\frac{1}{k}$.}\r\n\r\nYour task is to calculate, for each player $i$, the exact probability of being eliminated after the next round, returned modulo $998244353$.","authorLogin":"shishirbandy","language":"english","timeLimit":10000,"output":"A single line containing $n$ integers, space separated, where the $i^{\\text{th}}$ integer represents the probability $\\text{mod } 998244353$ that player $i$ is eliminated.\r\n\r\nIt can be shown that the expected value has the form $\\frac{P}{Q}$, where $P$ and $Q$ are non-negative coprime integers, and $Q \\neq 0$. Report the value of $P \\cdot Q^{-1} \\pmod{998244353}$.","inputFile":"stdin","outputFile":"stdout","input":"The first line contains $t \\; (1 \\leqslant t \\leqslant 20)$, the number of test cases.\r\n\r\nThen, $t$ test cases follow and for each test case:\r\n\r\nThe first line contains one integer, $n \\, (1 \\leqslant n \\leqslant \\bf{150})$\r\n\r\nThe second line contains $n$ space separated integers, where $p_i \\, (0 \\leqslant p_i \\leqslant 10^9)$ represents the current score of player $i$.\r\n\r\nThe third line contains $n$ space separated integers, where $s_i \\, (0 \\leqslant s_i \\leqslant 10^9)$ represents the score bonus associated with $i^{\\text{th}}$ place.\r\n\r\nIt is guaranteed that the sum of $n$ over all test cases will not exceed $\\bf{150}$.","authorName":"DengLiren19","sampleTests":[{"output":"166374059 332748118 499122177 \r\n0 58230921 58230921 144190851 737591661 0 \r\n249561089 748683265 \r\n","input":"3\r\n3\r\n60 40 20\r\n100 50 25\r\n6\r\n7495 4929 5117 6657 5763 7521\r\n5767 4037 2833 2307 1730 1442\r\n2\r\n3 4\r\n5 4\r\n","inputFile":"example.01","outputFile":"example.01.a"}],"name":"C.O.B.E.N (Hard Version)","interaction":null,"memoryLimit":536870912,"tutorial":"hi"}